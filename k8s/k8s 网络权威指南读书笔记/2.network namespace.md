# Network Namespace æ·±åº¦è§£æ

## ğŸ“– ä»€ä¹ˆæ˜¯ Network Namespaceï¼Ÿ

**Network Namespace** æ˜¯ Linux å†…æ ¸æä¾›çš„ç½‘ç»œåè®®æ ˆéš”ç¦»æœºåˆ¶ï¼Œå®ƒä¸ºæ¯ä¸ª namespace åˆ›å»ºç‹¬ç«‹çš„ç½‘ç»œç¯å¢ƒï¼ŒåŒ…æ‹¬ç½‘ç»œæ¥å£ã€è·¯ç”±è¡¨ã€é˜²ç«å¢™è§„åˆ™ã€å¥—æ¥å­—ç­‰ã€‚è¿™æ˜¯å®¹å™¨ç½‘ç»œéš”ç¦»çš„æ ¸å¿ƒæŠ€æœ¯ã€‚

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- **å®Œæ•´çš„ç½‘ç»œåè®®æ ˆéš”ç¦»**: æ¯ä¸ª namespace æœ‰ç‹¬ç«‹çš„ç½‘ç»œæ ˆ
- **ç‹¬ç«‹çš„ç½‘ç»œæ¥å£**: å¯ä»¥æœ‰è‡ªå·±çš„ç½‘å¡ã€å›ç¯æ¥å£ç­‰
- **ç‹¬ç«‹çš„è·¯ç”±è¡¨**: ä¸åŒ namespace çš„è·¯ç”±ç­–ç•¥å®Œå…¨éš”ç¦»
- **ç‹¬ç«‹çš„é˜²ç«å¢™è§„åˆ™**: iptables è§„åˆ™äº’ä¸å½±å“
- **ç‹¬ç«‹çš„ç½‘ç»œç»Ÿè®¡**: ç‹¬ç«‹çš„ç½‘ç»œè®¡æ•°å™¨å’Œç»Ÿè®¡ä¿¡æ¯

### ğŸ” Network Namespace åŒ…å«çš„èµ„æº

```
Network Namespace éš”ç¦»çš„ç½‘ç»œèµ„æº:
â”œâ”€â”€ ç½‘ç»œæ¥å£ (Network Interfaces)
â”œâ”€â”€ IP åœ°å€ (IP Addresses)  
â”œâ”€â”€ è·¯ç”±è¡¨ (Routing Tables)
â”œâ”€â”€ é˜²ç«å¢™è§„åˆ™ (iptables/netfilter rules)
â”œâ”€â”€ /proc/net ç›®å½•
â”œâ”€â”€ /sys/class/net ç›®å½•
â”œâ”€â”€ å¥—æ¥å­— (Sockets)
â”œâ”€â”€ ç½‘ç»œç»Ÿè®¡ä¿¡æ¯
â””â”€â”€ ç«¯å£å·ç©ºé—´
```

## ğŸ› ï¸ åŸºç¡€æ“ä½œå‘½ä»¤

### 1. åˆ›å»ºå’Œç®¡ç† Network Namespace

#### åˆ›å»º Network Namespace
```bash
# åˆ›å»ºä¸€ä¸ªæ–°çš„ network namespace
ip netns add test-ns

# æŸ¥çœ‹æ‰€æœ‰ network namespace
ip netns list
ip netns show  # åŒä¸Š

# åˆ é™¤ network namespace
ip netns delete test-ns
```

#### æŸ¥çœ‹ Namespace è¯¦ç»†ä¿¡æ¯
```bash
# æŸ¥çœ‹å½“å‰è¿›ç¨‹çš„ network namespace
ls -la /proc/self/ns/net

# æŸ¥çœ‹æŒ‡å®šè¿›ç¨‹çš„ network namespace  
ls -la /proc/PID/ns/net

# æ¯”è¾ƒä¸¤ä¸ªè¿›ç¨‹çš„ network namespace æ˜¯å¦ç›¸åŒ
ls -la /proc/1/ns/net /proc/self/ns/net
```

### 2. åœ¨ Network Namespace ä¸­æ‰§è¡Œå‘½ä»¤

#### åŸºæœ¬å‘½ä»¤æ‰§è¡Œ
```bash
# åœ¨æŒ‡å®š namespace ä¸­æ‰§è¡Œå•ä¸ªå‘½ä»¤
ip netns exec test-ns ip addr show

# åœ¨æŒ‡å®š namespace ä¸­å¯åŠ¨ shell
ip netns exec test-ns /bin/bash

# åœ¨æŒ‡å®š namespace ä¸­æ‰§è¡Œç½‘ç»œé…ç½®å‘½ä»¤
ip netns exec test-ns ip link set lo up
```

## ğŸ§ª å®è·µæµ‹è¯•ï¼šç†è§£ Network Namespace

### æµ‹è¯• 1: åˆ›å»ºåŸºç¡€çš„ç½‘ç»œéš”ç¦»ç¯å¢ƒ

```bash
#!/bin/bash
echo "=== æµ‹è¯• 1: åŸºç¡€ç½‘ç»œéš”ç¦» ==="

# 1. æŸ¥çœ‹ä¸»æœºç½‘ç»œçŠ¶æ€
echo "1. ä¸»æœºç½‘ç»œæ¥å£:"
ip addr show

echo -e "\n2. ä¸»æœºè·¯ç”±è¡¨:"
ip route show

# 2. åˆ›å»ºæ–°çš„ network namespace
echo -e "\n3. åˆ›å»º network namespace:"
ip netns add net-test
ip netns list

# 3. æŸ¥çœ‹æ–° namespace çš„ç½‘ç»œçŠ¶æ€ï¼ˆåˆå§‹ä¸ºç©ºï¼‰
echo -e "\n4. æ–° namespace çš„ç½‘ç»œæ¥å£:"
ip netns exec net-test ip addr show

echo -e "\n5. æ–° namespace çš„è·¯ç”±è¡¨:"
ip netns exec net-test ip route show

# 4. å¯ç”¨æ–° namespace çš„å›ç¯æ¥å£
echo -e "\n6. å¯ç”¨å›ç¯æ¥å£:"
ip netns exec net-test ip link set lo up
ip netns exec net-test ip addr show lo

# 5. æµ‹è¯•ç½‘ç»œè¿é€šæ€§
echo -e "\n7. æµ‹è¯•è¿é€šæ€§:"
echo "ä¸»æœº ping æœ¬åœ°å›ç¯:"
ping -c 1 127.0.0.1

echo "namespace å†… ping æœ¬åœ°å›ç¯:"
ip netns exec net-test ping -c 1 127.0.0.1
```

### æµ‹è¯• 2: ä½¿ç”¨ veth pair è¿æ¥ä¸åŒçš„ Network Namespace

```bash
#!/bin/bash
echo "=== æµ‹è¯• 2: veth pair è¿æ¥ ==="

# 1. åˆ›å»ºä¸¤ä¸ª network namespace
ip netns add ns1
ip netns add ns2

# 2. åˆ›å»º veth pairï¼ˆè™šæ‹Ÿä»¥å¤ªç½‘å¯¹ï¼‰
echo "1. åˆ›å»º veth pair:"
ip link add veth1 type veth peer name veth2

# 3. æŸ¥çœ‹åˆ›å»ºçš„ veth pair
echo "2. æŸ¥çœ‹ veth pair:"
ip link show | grep veth

# 4. å°† veth æ¥å£åˆ†é…åˆ°ä¸åŒçš„ namespace
echo "3. åˆ†é…æ¥å£åˆ°ä¸åŒ namespace:"
ip link set veth1 netns ns1
ip link set veth2 netns ns2

# 5. éªŒè¯æ¥å£å·²ç§»åŠ¨åˆ°å¯¹åº” namespace
echo "4. éªŒè¯æ¥å£åˆ†é…:"
echo "ä¸»æœºæ¥å£ (åº”è¯¥çœ‹ä¸åˆ° veth1, veth2):"
ip link show | grep veth || echo "veth æ¥å£å·²ç§»åŠ¨"

echo "ns1 ä¸­çš„æ¥å£:"
ip netns exec ns1 ip link show

echo "ns2 ä¸­çš„æ¥å£:"
ip netns exec ns2 ip link show

# 6. é…ç½®æ¥å£ IP åœ°å€
echo "5. é…ç½® IP åœ°å€:"
ip netns exec ns1 ip addr add 192.168.100.1/24 dev veth1
ip netns exec ns1 ip link set veth1 up
ip netns exec ns1 ip link set lo up

ip netns exec ns2 ip addr add 192.168.100.2/24 dev veth2
ip netns exec ns2 ip link set veth2 up
ip netns exec ns2 ip link set lo up

# 7. æŸ¥çœ‹é…ç½®ç»“æœ
echo "6. æŸ¥çœ‹é…ç½®ç»“æœ:"
echo "ns1 çš„ç½‘ç»œé…ç½®:"
ip netns exec ns1 ip addr show
ip netns exec ns1 ip route show

echo "ns2 çš„ç½‘ç»œé…ç½®:"
ip netns exec ns2 ip addr show
ip netns exec ns2 ip route show

# 8. æµ‹è¯•è¿é€šæ€§
echo "7. æµ‹è¯• namespace é—´è¿é€šæ€§:"
echo "ä» ns1 ping ns2:"
ip netns exec ns1 ping -c 3 192.168.100.2

echo "ä» ns2 ping ns1:"
ip netns exec ns2 ping -c 3 192.168.100.1
```

### æµ‹è¯• 3: ç½‘æ¡¥è¿æ¥å¤šä¸ª Network Namespace

```bash
#!/bin/bash
echo "=== æµ‹è¯• 3: ç½‘æ¡¥è¿æ¥å¤šä¸ª namespace ==="

# 1. åˆ›å»ºç½‘æ¡¥
echo "1. åˆ›å»ºç½‘æ¡¥:"
ip link add name br0 type bridge
ip link set br0 up
ip addr add 192.168.200.1/24 dev br0

# 2. åˆ›å»ºå¤šä¸ª namespace
echo "2. åˆ›å»ºå¤šä¸ª namespace:"
for i in {1..3}; do
    ip netns add ns${i}
    echo "åˆ›å»º ns${i}"
done

# 3. ä¸ºæ¯ä¸ª namespace åˆ›å»º veth pair å¹¶è¿æ¥åˆ°ç½‘æ¡¥
echo "3. è¿æ¥ namespace åˆ°ç½‘æ¡¥:"
for i in {1..3}; do
    # åˆ›å»º veth pair
    ip link add veth${i} type veth peer name veth${i}-br
    
    # å°†ä¸€ç«¯è¿æ¥åˆ°ç½‘æ¡¥
    ip link set veth${i}-br master br0
    ip link set veth${i}-br up
    
    # å°†å¦ä¸€ç«¯ç§»åŠ¨åˆ° namespace
    ip link set veth${i} netns ns${i}
    
    # åœ¨ namespace ä¸­é…ç½®æ¥å£
    ip netns exec ns${i} ip link set veth${i} up
    ip netns exec ns${i} ip link set lo up
    ip netns exec ns${i} ip addr add 192.168.200.1${i}/24 dev veth${i}
    ip netns exec ns${i} ip route add default via 192.168.200.1
    
    echo "ns${i} é…ç½®å®Œæˆ: 192.168.200.1${i}/24"
done

# 4. æŸ¥çœ‹ç½‘æ¡¥çŠ¶æ€
echo "4. ç½‘æ¡¥çŠ¶æ€:"
ip link show br0
bridge link show

# 5. æµ‹è¯•è¿é€šæ€§
echo "5. æµ‹è¯• namespace é—´è¿é€šæ€§:"
echo "ä» ns1 ping ns2:"
ip netns exec ns1 ping -c 2 192.168.200.12

echo "ä» ns2 ping ns3:"
ip netns exec ns2 ping -c 2 192.168.200.13

echo "ä» ns1 ping ç½‘æ¡¥:"
ip netns exec ns1 ping -c 2 192.168.200.1
```

### æµ‹è¯• 4: ç«¯å£éš”ç¦»æµ‹è¯•

```bash
#!/bin/bash
echo "=== æµ‹è¯• 4: ç«¯å£éš”ç¦»æµ‹è¯• ==="

# 1. åœ¨ä¸»æœºä¸Šå¯åŠ¨æœåŠ¡
echo "1. åœ¨ä¸»æœºä¸Šå¯åŠ¨ HTTP æœåŠ¡ (ç«¯å£ 8080):"
python3 -m http.server 8080 &
HOST_PID=$!
sleep 2

# 2. åˆ›å»º namespace å¹¶é…ç½®ç½‘ç»œ
ip netns add port-test
ip link add veth-host type veth peer name veth-ns
ip link set veth-ns netns port-test

# é…ç½®ä¸»æœºç«¯
ip addr add 10.0.0.1/24 dev veth-host
ip link set veth-host up

# é…ç½® namespace ç«¯
ip netns exec port-test ip addr add 10.0.0.2/24 dev veth-ns
ip netns exec port-test ip link set veth-ns up
ip netns exec port-test ip link set lo up

# 3. åœ¨ namespace ä¸­ä¹Ÿå¯åŠ¨ç›¸åŒç«¯å£çš„æœåŠ¡
echo "2. åœ¨ namespace ä¸­å¯åŠ¨ HTTP æœåŠ¡ (åŒæ ·ç«¯å£ 8080):"
ip netns exec port-test python3 -m http.server 8080 &
NS_PID=$!
sleep 2

# 4. æµ‹è¯•ç«¯å£éš”ç¦»
echo "3. æµ‹è¯•ç«¯å£éš”ç¦»æ•ˆæœ:"
echo "ä¸»æœºä¸Šçš„æœåŠ¡ç›‘å¬çŠ¶æ€:"
netstat -tlnp | grep :8080

echo "namespace ä¸­çš„æœåŠ¡ç›‘å¬çŠ¶æ€:"
ip netns exec port-test netstat -tlnp | grep :8080

echo "ä»ä¸»æœºè®¿é—®ä¸»æœºæœåŠ¡:"
curl -s http://localhost:8080/ | head -1

echo "ä» namespace è®¿é—® namespace æœåŠ¡:"
ip netns exec port-test curl -s http://localhost:8080/ | head -1

# 5. æ¸…ç†
kill $HOST_PID $NS_PID 2>/dev/null
```

### æµ‹è¯• 5: é˜²ç«å¢™è§„åˆ™éš”ç¦»

```bash
#!/bin/bash
echo "=== æµ‹è¯• 5: é˜²ç«å¢™è§„åˆ™éš”ç¦» ==="

# 1. æŸ¥çœ‹ä¸»æœº iptables è§„åˆ™
echo "1. ä¸»æœºå½“å‰ iptables è§„åˆ™:"
iptables -L INPUT -n --line-numbers

# 2. åˆ›å»º namespace
ip netns add fw-test
ip link add veth-fw-host type veth peer name veth-fw-ns
ip link set veth-fw-ns netns fw-test

# é…ç½®ç½‘ç»œ
ip addr add 172.16.0.1/24 dev veth-fw-host
ip link set veth-fw-host up

ip netns exec fw-test ip addr add 172.16.0.2/24 dev veth-fw-ns
ip netns exec fw-test ip link set veth-fw-ns up
ip netns exec fw-test ip link set lo up

# 3. åœ¨ä¸»æœºä¸Šæ·»åŠ é˜²ç«å¢™è§„åˆ™
echo "2. åœ¨ä¸»æœºä¸Šæ·»åŠ é˜²ç«å¢™è§„åˆ™ (ç¦æ­¢ ping):"
iptables -A INPUT -p icmp --icmp-type echo-request -j DROP

# 4. åœ¨ namespace ä¸­æ·»åŠ ä¸åŒçš„é˜²ç«å¢™è§„åˆ™
echo "3. åœ¨ namespace ä¸­æ·»åŠ é˜²ç«å¢™è§„åˆ™ (å…è®¸ ping):"
ip netns exec fw-test iptables -A INPUT -p icmp --icmp-type echo-request -j ACCEPT

# 5. æµ‹è¯•é˜²ç«å¢™è§„åˆ™éš”ç¦»
echo "4. æµ‹è¯•é˜²ç«å¢™è§„åˆ™éš”ç¦»:"
echo "ä¸»æœºé˜²ç«å¢™è§„åˆ™:"
iptables -L INPUT -n | grep icmp

echo "namespace é˜²ç«å¢™è§„åˆ™:"
ip netns exec fw-test iptables -L INPUT -n | grep icmp

echo "æµ‹è¯•ä¸»æœº ping (åº”è¯¥è¢«é˜»æ­¢):"
timeout 3 ping -c 1 127.0.0.1 || echo "ping è¢«é˜²ç«å¢™é˜»æ­¢"

echo "æµ‹è¯• namespace å†… ping (åº”è¯¥æˆåŠŸ):"
ip netns exec fw-test ping -c 1 127.0.0.1

# 6. æ¸…ç†é˜²ç«å¢™è§„åˆ™
echo "5. æ¸…ç†é˜²ç«å¢™è§„åˆ™:"
iptables -D INPUT -p icmp --icmp-type echo-request -j DROP 2>/dev/null
```

## ğŸ” æ·±å…¥ç†è§£æµ‹è¯•

### æµ‹è¯• 6: è§‚å¯Ÿ Network Namespace çš„å†…éƒ¨ç»“æ„

```bash
#!/bin/bash
echo "=== æµ‹è¯• 6: Network Namespace å†…éƒ¨ç»“æ„åˆ†æ ==="

# 1. åˆ›å»ºæµ‹è¯• namespace
ip netns add inspect-ns

# 2. è§‚å¯Ÿ /proc/net ç›®å½•çš„å˜åŒ–
echo "1. æ¯”è¾ƒ /proc/net ç›®å½•:"
echo "ä¸»æœº /proc/net å†…å®¹:"
ls /proc/net/ | head -5

echo "namespace /proc/net å†…å®¹:"
ip netns exec inspect-ns ls /proc/net/ | head -5

# 3. è§‚å¯Ÿç½‘ç»œç»Ÿè®¡ä¿¡æ¯
echo "2. ç½‘ç»œç»Ÿè®¡ä¿¡æ¯å¯¹æ¯”:"
echo "ä¸»æœºç½‘ç»œç»Ÿè®¡:"
cat /proc/net/dev | head -3

echo "namespace ç½‘ç»œç»Ÿè®¡:"
ip netns exec inspect-ns cat /proc/net/dev | head -3

# 4. è§‚å¯Ÿå¥—æ¥å­—ä¿¡æ¯
echo "3. å¥—æ¥å­—ä¿¡æ¯å¯¹æ¯”:"
echo "ä¸»æœºå¥—æ¥å­—æ•°é‡:"
ss -s

echo "namespace å¥—æ¥å­—æ•°é‡:"
ip netns exec inspect-ns ss -s

# 5. è§‚å¯Ÿè·¯ç”±ç¼“å­˜
echo "4. è·¯ç”±ç¼“å­˜å¯¹æ¯”:"
echo "ä¸»æœºè·¯ç”±ç¼“å­˜:"
ip route show cache 2>/dev/null | wc -l

echo "namespace è·¯ç”±ç¼“å­˜:"
ip netns exec inspect-ns ip route show cache 2>/dev/null | wc -l
```

## ğŸ“‹ æ·±å…¥è§£æï¼šip addr show è¾“å‡ºå­—æ®µ

### å…¸å‹è¾“å‡ºç¤ºä¾‹
```bash
$ ip addr show
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UP group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff
    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::42:acff:fe11:2/64 scope link 
       valid_lft forever preferred_lft forever
```

### ğŸ” å­—æ®µè¯¦ç»†è§£æ

#### **ç¬¬ä¸€è¡Œï¼šæ¥å£åŸºæœ¬ä¿¡æ¯**
```
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UP group default qlen 1000
```

**å­—æ®µè§£æï¼š**

##### 1. **`1:`** - æ¥å£ç´¢å¼•å·ï¼ˆInterface Indexï¼‰
- **ä½œç”¨**: ç³»ç»Ÿä¸ºæ¯ä¸ªç½‘ç»œæ¥å£åˆ†é…çš„å”¯ä¸€æ•°å­—æ ‡è¯†ç¬¦
- **èŒƒå›´**: é€šå¸¸ä» 1 å¼€å§‹é€’å¢
- **ç‰¹ç‚¹**: æ¥å£åˆ é™¤åï¼Œç´¢å¼•å·å¯èƒ½è¢«é‡æ–°ä½¿ç”¨
- **ç¤ºä¾‹**: `1:` (å›ç¯æ¥å£é€šå¸¸æ˜¯1), `2:` (ç¬¬ä¸€ä¸ªä»¥å¤ªç½‘æ¥å£)

##### 2. **`lo:`** - æ¥å£åç§°ï¼ˆInterface Nameï¼‰
- **ä½œç”¨**: äººç±»å¯è¯»çš„æ¥å£åç§°æ ‡è¯†ç¬¦
- **å‘½åè§„åˆ™**: 
  - `lo` - å›ç¯æ¥å£ï¼ˆLoopbackï¼‰
  - `eth0, eth1` - ä»¥å¤ªç½‘æ¥å£
  - `wlan0, wlan1` - æ— çº¿ç½‘å¡æ¥å£
  - `docker0` - Docker ç½‘æ¡¥æ¥å£
  - `veth*` - è™šæ‹Ÿä»¥å¤ªç½‘å¯¹æ¥å£
  - `br-*` - ç½‘æ¡¥æ¥å£
- **é•¿åº¦é™åˆ¶**: æœ€å¤§15ä¸ªå­—ç¬¦

##### 3. **`<LOOPBACK,UP,LOWER_UP>`** - æ¥å£æ ‡å¿—ä½ï¼ˆInterface Flagsï¼‰
- **ä½œç”¨**: è¡¨ç¤ºæ¥å£çš„å„ç§çŠ¶æ€å’Œç‰¹æ€§
- **æ ¼å¼**: ç”¨å°–æ‹¬å·åŒ…å›´ï¼Œå¤šä¸ªæ ‡å¿—ç”¨é€—å·åˆ†éš”
- **è¯¦ç»†å«ä¹‰è§ä¸‹æ–¹æ ‡å¿—ä½è¯¦è§£**

##### 4. **`mtu 65536`** - æœ€å¤§ä¼ è¾“å•å…ƒï¼ˆMaximum Transmission Unitï¼‰
- **ä½œç”¨**: è¯¥æ¥å£èƒ½ä¼ è¾“çš„æœ€å¤§æ•°æ®åŒ…å¤§å°ï¼ˆå­—èŠ‚ï¼‰
- **å¸¸è§å€¼**:
  - `65536` - å›ç¯æ¥å£ï¼ˆç†è®ºæœ€å¤§å€¼ï¼‰
  - `1500` - æ ‡å‡†ä»¥å¤ªç½‘
  - `9000` - å·¨å¸§ä»¥å¤ªç½‘
  - `1280` - IPv6 æœ€å° MTU
- **å½±å“**: å½±å“ç½‘ç»œæ€§èƒ½å’Œåˆ†ç‰‡è¡Œä¸º

##### 5. **`qdisc noqueue`** - é˜Ÿåˆ—è§„åˆ™ï¼ˆQueueing Disciplineï¼‰
- **ä½œç”¨**: æ§åˆ¶æ•°æ®åŒ…å¦‚ä½•æ’é˜Ÿå’Œè°ƒåº¦å‘é€
- **å¸¸è§ç±»å‹**:
  - `noqueue` - æ— é˜Ÿåˆ—ï¼ˆå›ç¯æ¥å£å¸¸ç”¨ï¼‰
  - `pfifo_fast` - å¿«é€Ÿå…ˆè¿›å…ˆå‡ºé˜Ÿåˆ—ï¼ˆé»˜è®¤ï¼‰
  - `fq` - å…¬å¹³é˜Ÿåˆ—
  - `fq_codel` - å—æ§å»¶è¿Ÿå…¬å¹³é˜Ÿåˆ—
  - `htb` - åˆ†å±‚ä»¤ç‰Œæ¡¶
  - `tbf` - ä»¤ç‰Œæ¡¶è¿‡æ»¤å™¨
  - `nop` - æ— æ“ä½œé˜Ÿåˆ—ï¼ˆNo Operationï¼‰
  - `mq` - å¤šé˜Ÿåˆ—è°ƒåº¦å™¨ï¼ˆMulti-Queueï¼‰
- **è¯¦ç»†è¯´æ˜**:
  - **`nop`**: æ— æ“ä½œé˜Ÿåˆ—ï¼Œç›´æ¥ä¼ é€’æ•°æ®åŒ…è€Œä¸è¿›è¡Œä»»ä½•é˜Ÿåˆ—æ“ä½œï¼Œé€šå¸¸ç”¨äºè™šæ‹Ÿæ¥å£æˆ–æµ‹è¯•åœºæ™¯
  - **`mq`**: å¤šé˜Ÿåˆ—è°ƒåº¦å™¨ï¼Œä¸ºå¤šæ ¸ç³»ç»Ÿä¼˜åŒ–ï¼Œæ¯ä¸ªCPUæ ¸å¿ƒæœ‰ç‹¬ç«‹çš„å‘é€é˜Ÿåˆ—ï¼Œæé«˜å¹¶å‘æ€§èƒ½
- **æ€§èƒ½å½±å“**: ç›´æ¥å½±å“ç½‘ç»œååé‡å’Œå»¶è¿Ÿ

##### 6. **`state UP`** - æ¥å£çŠ¶æ€ï¼ˆInterface Stateï¼‰
- **ä½œç”¨**: è¡¨ç¤ºæ¥å£çš„æ“ä½œçŠ¶æ€
- **å¯èƒ½å€¼**:
  - `UP` - æ¥å£å·²å¯ç”¨ä¸”å¯æ“ä½œ
  - `DOWN` - æ¥å£å·²ç¦ç”¨
  - `UNKNOWN` - çŠ¶æ€æœªçŸ¥
  - `DORMANT` - æ¥å£ä¼‘çœ 
  - `LOWERLAYERDOWN` - åº•å±‚æ¥å£æ•…éšœ
  - `NOTPRESENT` - æ¥å£ä¸å­˜åœ¨
  - `TESTING` - æµ‹è¯•æ¨¡å¼
- **åŒºåˆ«**: è¿™æ˜¯æ“ä½œçŠ¶æ€ï¼Œä¸ç®¡ç†çŠ¶æ€ï¼ˆUPæ ‡å¿—ï¼‰ä¸åŒ

##### 7. **`group default`** - æ¥å£ç»„ï¼ˆInterface Groupï¼‰
- **ä½œç”¨**: å°†æ¥å£åˆ†ç»„ç®¡ç†ï¼Œä¾¿äºæ‰¹é‡æ“ä½œ
- **é»˜è®¤å€¼**: `default` (ç»„IDä¸º0)
- **ç”¨é€”**: 
  - æ‰¹é‡é…ç½®å¤šä¸ªæ¥å£
  - ç½‘ç»œç­–ç•¥åº”ç”¨
  - ç›‘æ§å’Œç®¡ç†
- **æ“ä½œç¤ºä¾‹**: `ip link set group 1 dev eth0`

##### 8. **`qlen 1000`** - å‘é€é˜Ÿåˆ—é•¿åº¦ï¼ˆQueue Lengthï¼‰
- **ä½œç”¨**: ç½‘ç»œæ¥å£å‘é€é˜Ÿåˆ—å¯å®¹çº³çš„æ•°æ®åŒ…æ•°é‡
- **é»˜è®¤å€¼**: 
  - ä»¥å¤ªç½‘æ¥å£é€šå¸¸ä¸º `1000`
  - å›ç¯æ¥å£é€šå¸¸ä¸º `1000`
  - é«˜é€Ÿæ¥å£å¯èƒ½æ›´å¤§
- **æ€§èƒ½å½±å“**: 
  - å¤ªå°ï¼šå¯èƒ½ä¸¢åŒ…
  - å¤ªå¤§ï¼šå¢åŠ å»¶è¿Ÿ
- **è°ƒæ•´**: `ip link set qlen 2000 dev eth0`

#### **æ¥å£æ ‡å¿—ä½è¯¦è§£**
```bash
å¸¸è§æ ‡å¿—ä½å«ä¹‰ï¼š
<LOOPBACK>      - å›ç¯æ¥å£
<BROADCAST>     - æ”¯æŒå¹¿æ’­
<MULTICAST>     - æ”¯æŒå¤šæ’­
<UP>           - æ¥å£å·²å¯ç”¨ï¼ˆç®¡ç†çŠ¶æ€ï¼‰
<LOWER_UP>     - ç‰©ç†å±‚è¿æ¥æ­£å¸¸
<RUNNING>      - æ¥å£æ­£åœ¨è¿è¡Œ
<NOARP>        - ä¸ä½¿ç”¨ARPåè®®
<PROMISC>      - æ··æ‚æ¨¡å¼
<ALLMULTI>     - æ¥æ”¶æ‰€æœ‰å¤šæ’­åŒ…
<MASTER>       - ä¸»æ¥å£ï¼ˆå¦‚ç½‘æ¡¥ï¼‰
<SLAVE>        - ä»æ¥å£ï¼ˆæ¡¥æ¥æˆå‘˜ï¼‰
<DYNAMIC>      - åŠ¨æ€åˆ›å»ºçš„æ¥å£
<DORMANT>      - æ¥å£ä¼‘çœ çŠ¶æ€
<POINTOPOINT>  - ç‚¹å¯¹ç‚¹è¿æ¥
<NOTRAILERS>   - é¿å…ä½¿ç”¨å°¾éƒ¨
<ECHO>         - å›æ˜¾å‘é€çš„åŒ…
```

#### **å®ç”¨çš„ç¬¬ä¸€è¡Œå­—æ®µæŸ¥çœ‹å‘½ä»¤**
```bash
# 1. åªæ˜¾ç¤ºæ¥å£åŸºæœ¬ä¿¡æ¯ï¼ˆç¬¬ä¸€è¡Œï¼‰
ip link show

# 2. æ˜¾ç¤ºç‰¹å®šæ¥å£çš„è¯¦ç»†ä¿¡æ¯
ip link show dev eth0

# 3. æå–æ¥å£ç´¢å¼•å·
ip link show | grep "^[0-9]" | cut -d: -f1

# 4. æå–æ¥å£åç§°
ip link show | grep "^[0-9]" | cut -d: -f2 | awk '{print $1}'

# 5. æ£€æŸ¥æ¥å£çŠ¶æ€
ip link show | grep "state UP"

# 6. æŸ¥çœ‹æ‰€æœ‰æ¥å£çš„ MTU
ip link show | grep -o "mtu [0-9]*"

# 7. æŸ¥çœ‹é˜Ÿåˆ—è§„åˆ™
ip link show | grep -o "qdisc [a-z_]*"

# 8. æ£€æŸ¥æ¥å£æ ‡å¿—ä½
ip link show | grep -o "<[^>]*>"

# 9. æ ¼å¼åŒ–æ˜¾ç¤ºç¬¬ä¸€è¡Œä¿¡æ¯
ip link show | awk '/^[0-9]+:/ {
    gsub(/:/, "", $1)
    gsub(/:/, "", $2)
    print "ç´¢å¼•:", $1, "æ¥å£:", $2, "çŠ¶æ€:", $9
}'

# 10. ç›‘æ§æ¥å£çŠ¶æ€å˜åŒ–
ip monitor link
```

#### **é˜Ÿåˆ—è§„åˆ™ï¼ˆqdiscï¼‰è¯¦ç»†è§£æ**
```bash
# æŸ¥çœ‹æ‰€æœ‰æ¥å£çš„é˜Ÿåˆ—è§„åˆ™
tc qdisc show

# æŸ¥çœ‹ç‰¹å®šæ¥å£çš„é˜Ÿåˆ—è§„åˆ™è¯¦æƒ…
tc qdisc show dev eth0

# æŸ¥çœ‹é˜Ÿåˆ—ç»Ÿè®¡ä¿¡æ¯
tc -s qdisc show dev eth0

# æŸ¥çœ‹æ‰€æœ‰æ¥å£çš„ qdisc ç±»å‹
ip link show | grep -o "qdisc [a-zA-Z0-9_]*"
```

#### **å¸¸è§ qdisc ç±»å‹å¯¹æ¯”è¡¨**

| qdisc ç±»å‹ | é€‚ç”¨åœºæ™¯ | æ€§èƒ½ç‰¹ç‚¹ | é…ç½®å¤æ‚åº¦ | å…¸å‹ç”¨é€” |
|-----------|----------|----------|------------|----------|
| **noqueue** | è™šæ‹Ÿæ¥å£ | æ— å»¶è¿Ÿ | ç®€å• | å›ç¯æ¥å£ã€è™šæ‹Ÿæ¥å£ |
| **nop** | æµ‹è¯•/è™šæ‹Ÿ | ç›´é€šæ— å¤„ç† | ç®€å• | æµ‹è¯•ç¯å¢ƒã€ç®€å•è™šæ‹Ÿæ¥å£ |
| **pfifo_fast** | é€šç”¨ä»¥å¤ªç½‘ | ä½å»¶è¿Ÿï¼Œ3ä¸ªä¼˜å…ˆçº§é˜Ÿåˆ— | ç®€å• | é»˜è®¤é˜Ÿåˆ—ï¼Œå¤§å¤šæ•°ç½‘å¡ |
| **mq** | å¤šæ ¸ç³»ç»Ÿ | é«˜å¹¶å‘ï¼Œæ¯æ ¸ä¸€é˜Ÿåˆ— | ä¸­ç­‰ | å¤šé˜Ÿåˆ—ç½‘å¡ï¼Œé«˜æ€§èƒ½æœåŠ¡å™¨ |
| **fq** | é«˜æ€§èƒ½ç½‘ç»œ | å…¬å¹³è°ƒåº¦ï¼Œä½å»¶è¿Ÿ | ä¸­ç­‰ | ç°ä»£é«˜é€Ÿç½‘ç»œ |
| **fq_codel** | ç¼“å†²åŒºè‡ƒè‚¿æ§åˆ¶ | æ™ºèƒ½é˜Ÿåˆ—ç®¡ç† | ä¸­ç­‰ | å‡å°‘ç½‘ç»œå»¶è¿Ÿ |
| **htb** | æµé‡æ§åˆ¶ | ç²¾ç¡®å¸¦å®½æ§åˆ¶ | å¤æ‚ | QoSã€å¸¦å®½é™åˆ¶ |
| **tbf** | ä»¤ç‰Œæ¡¶é™é€Ÿ | å¹³æ»‘æµé‡æ•´å½¢ | ä¸­ç­‰ | é€Ÿç‡é™åˆ¶ |

#### **qdisc å®æ—¶æŸ¥çœ‹å’Œåˆ†æ**
```bash
#!/bin/bash
echo "=== ç³»ç»Ÿ qdisc åˆ†æ ==="

echo "1. æ‰€æœ‰æ¥å£çš„é˜Ÿåˆ—è§„åˆ™:"
tc qdisc show

echo -e "\n2. æŒ‰ç±»å‹ç»Ÿè®¡ qdisc:"
tc qdisc show | awk '{print $2}' | sort | uniq -c

echo -e "\n3. æŸ¥æ‰¾å¤šé˜Ÿåˆ—æ¥å£:"
tc qdisc show | grep "qdisc mq"

echo -e "\n4. æŸ¥æ‰¾æ— æ“ä½œé˜Ÿåˆ—:"
tc qdisc show | grep "qdisc nop"

echo -e "\n5. è¯¦ç»†çš„é˜Ÿåˆ—ç»Ÿè®¡ä¿¡æ¯:"
for iface in $(ip link show | grep "^[0-9]" | cut -d: -f2 | awk '{print $1}'); do
    echo "æ¥å£: $iface"
    tc -s qdisc show dev $iface 2>/dev/null | head -3
    echo "---"
done
```

#### **qdisc æ€§èƒ½ç‰¹æ€§è¯¦è§£**

##### **nop (No Operation) é˜Ÿåˆ—**
```bash
# ç‰¹æ€§ï¼š
- æ— ä»»ä½•é˜Ÿåˆ—æ“ä½œï¼Œç›´æ¥ä¼ é€’æ•°æ®åŒ…
- é›¶å¼€é”€ï¼Œæœ€ä½å»¶è¿Ÿ
- é€‚ç”¨äºä¸éœ€è¦é˜Ÿåˆ—ç®¡ç†çš„åœºæ™¯

# å¸¸è§äºï¼š
- è™šæ‹Ÿç½‘ç»œæ¥å£
- å®¹å™¨å†…éƒ¨æ¥å£
- æµ‹è¯•ç¯å¢ƒ

# æŸ¥çœ‹ nop é˜Ÿåˆ—ï¼š
tc qdisc show | grep nop
```

##### **mq (Multi-Queue) è°ƒåº¦å™¨**
```bash
# ç‰¹æ€§ï¼š
- æ¯ä¸ª CPU æ ¸å¿ƒç‹¬ç«‹çš„å‘é€é˜Ÿåˆ—
- æ”¯æŒç½‘å¡çš„å¤šé˜Ÿåˆ—ç‰¹æ€§
- æé«˜å¤šæ ¸ç³»ç»Ÿçš„ç½‘ç»œå¹¶å‘æ€§èƒ½
- å‡å°‘é”ç«äº‰

# é€‚ç”¨äºï¼š
- å¤šé˜Ÿåˆ—ç½‘å¡ (æ”¯æŒ RSS/å¤šé˜Ÿåˆ—çš„ç°ä»£ç½‘å¡)
- é«˜æ€§èƒ½æœåŠ¡å™¨
- å¤§æµé‡åœºæ™¯

# æŸ¥çœ‹ mq é˜Ÿåˆ—è¯¦æƒ…ï¼š
tc qdisc show dev eth0 | grep mq
tc -s class show dev eth0  # æŸ¥çœ‹æ¯ä¸ªé˜Ÿåˆ—çš„ç»Ÿè®¡
```

#### **æŸ¥è¯¢ç½‘å¡é˜Ÿåˆ—æ•°é‡çš„æ–¹æ³•**

##### **æ–¹æ³•1: ä½¿ç”¨ ethtool æŸ¥è¯¢ç¡¬ä»¶é˜Ÿåˆ—**
```bash
# æŸ¥çœ‹ç½‘å¡çš„æ¥æ”¶å’Œå‘é€é˜Ÿåˆ—æ•°é‡
ethtool -l eth0

# æŸ¥çœ‹æ‰€æœ‰ç½‘å¡çš„é˜Ÿåˆ—ä¿¡æ¯
for iface in $(ls /sys/class/net/); do
    echo "=== $iface ==="
    ethtool -l $iface 2>/dev/null || echo "ä¸æ”¯æŒæˆ–æ— æƒé™"
done

# åªæ˜¾ç¤ºæ”¯æŒå¤šé˜Ÿåˆ—çš„ç½‘å¡
for iface in $(ls /sys/class/net/); do
    if ethtool -l $iface 2>/dev/null | grep -q "Combined:"; then
        echo "ç½‘å¡ $iface æ”¯æŒå¤šé˜Ÿåˆ—:"
        ethtool -l $iface | grep -E "(RX:|TX:|Combined:)"
    fi
done
```

#### **ethtool é˜Ÿåˆ—è¾“å‡ºè¯¦ç»†è§£æ**

##### **å…¸å‹è¾“å‡ºç¤ºä¾‹**
```bash
$ ethtool -l eth0
Channel parameters for eth0:
Pre-set maximums:
RX:             0
TX:             0
Other:          0
Combined:       32
Current hardware settings:
RX:             0
TX:             0
Other:          0
Combined:       32
```

##### **å­—æ®µå«ä¹‰è¯¦è§£**

**1. Channel parameters for eth0:**
- æ˜¾ç¤º eth0 ç½‘å¡çš„é€šé“ï¼ˆé˜Ÿåˆ—ï¼‰å‚æ•°ä¿¡æ¯

**2. Pre-set maximums: (é¢„è®¾æœ€å¤§å€¼)**
- **RX: 0** - ä¸“ç”¨æ¥æ”¶é˜Ÿåˆ—çš„æœ€å¤§æ•°é‡ï¼ˆRX = Receiveï¼Œæ¥æ”¶ï¼‰ï¼ˆæ­¤ç½‘å¡ä¸æ”¯æŒç‹¬ç«‹RXé˜Ÿåˆ—ï¼‰
- **TX: 0** - ä¸“ç”¨å‘é€é˜Ÿåˆ—çš„æœ€å¤§æ•°é‡ï¼ˆTX = Transmitï¼Œå‘é€/ä¼ è¾“ï¼‰ï¼ˆæ­¤ç½‘å¡ä¸æ”¯æŒç‹¬ç«‹TXé˜Ÿåˆ—ï¼‰
- **Other: 0** - å…¶ä»–ç±»å‹é˜Ÿåˆ—çš„æœ€å¤§æ•°é‡ï¼ˆå¦‚ç®¡ç†é˜Ÿåˆ—ï¼‰
- **Combined: 32** - ç»„åˆé˜Ÿåˆ—çš„æœ€å¤§æ•°é‡ï¼ˆ32ä¸ªRX+TXç»„åˆé˜Ÿåˆ—ï¼‰

**3. Current hardware settings: (å½“å‰ç¡¬ä»¶è®¾ç½®)**
- **RX: 0** - å½“å‰é…ç½®çš„ä¸“ç”¨æ¥æ”¶é˜Ÿåˆ—æ•°é‡ï¼ˆReceive Queueï¼‰
- **TX: 0** - å½“å‰é…ç½®çš„ä¸“ç”¨å‘é€é˜Ÿåˆ—æ•°é‡ï¼ˆTransmit Queueï¼‰
- **Other: 0** - å½“å‰é…ç½®çš„å…¶ä»–é˜Ÿåˆ—æ•°é‡
- **Combined: 32** - å½“å‰é…ç½®çš„ç»„åˆé˜Ÿåˆ—æ•°é‡

##### **é˜Ÿåˆ—ç±»å‹è¯´æ˜**

```bash
# é˜Ÿåˆ—ç±»å‹è¯¦è§£:
RXé˜Ÿåˆ— (Receive Queue - æ¥æ”¶é˜Ÿåˆ—):
- ä¸“é—¨å¤„ç†æ•°æ®åŒ…æ¥æ”¶
- ç‹¬ç«‹çš„æ¥æ”¶å¤„ç†é€šé“
- é€‚ç”¨äºæ¥æ”¶å¯†é›†å‹å·¥ä½œè´Ÿè½½
- ä»ç½‘ç»œæ¥æ”¶æ•°æ®åŒ…å¹¶ä¼ é€’ç»™æ“ä½œç³»ç»Ÿ

TXé˜Ÿåˆ— (Transmit Queue - å‘é€/ä¼ è¾“é˜Ÿåˆ—):
- ä¸“é—¨å¤„ç†æ•°æ®åŒ…å‘é€
- ç‹¬ç«‹çš„å‘é€å¤„ç†é€šé“
- é€‚ç”¨äºå‘é€å¯†é›†å‹å·¥ä½œè´Ÿè½½
- å°†æ“ä½œç³»ç»Ÿçš„æ•°æ®åŒ…å‘é€åˆ°ç½‘ç»œ

Combinedé˜Ÿåˆ— (ç»„åˆé˜Ÿåˆ—):
- åŒæ—¶å¤„ç†æ¥æ”¶å’Œå‘é€
- æ¯ä¸ªé˜Ÿåˆ—æ—¢å¯ä»¥RXä¹Ÿå¯ä»¥TX
- æ›´çµæ´»çš„èµ„æºåˆ†é…
- ç°ä»£ç½‘å¡çš„ä¸»æµè®¾è®¡

Otheré˜Ÿåˆ—:
- ç®¡ç†å’Œæ§åˆ¶é˜Ÿåˆ—
- ä¸å¤„ç†æ•°æ®åŒ…æµé‡
- ç”¨äºç½‘å¡ç®¡ç†åŠŸèƒ½
```

##### **å®é™…æ„ä¹‰åˆ†æ**

**å¯¹äºç¤ºä¾‹è¾“å‡ºçš„è§£è¯»:**
```bash
# ç½‘å¡ç‰¹æ€§:
- è¯¥ç½‘å¡æ”¯æŒæœ€å¤š32ä¸ªç»„åˆé˜Ÿåˆ—
- ä¸æ”¯æŒç‹¬ç«‹çš„RX/TXé˜Ÿåˆ—
- å½“å‰ä½¿ç”¨å…¨éƒ¨32ä¸ªç»„åˆé˜Ÿåˆ—
- è¿™æ˜¯å…¸å‹çš„ç°ä»£é«˜æ€§èƒ½ç½‘å¡é…ç½®

# æ€§èƒ½å«ä¹‰:
- 32ä¸ªé˜Ÿåˆ—å¯ä»¥å……åˆ†åˆ©ç”¨å¤šæ ¸CPU
- ç»„åˆé˜Ÿåˆ—è®¾è®¡æä¾›æ›´å¥½çš„çµæ´»æ€§
- å¯ä»¥åŒæ—¶å¤„ç†32ä¸ªå¹¶å‘çš„æ”¶å‘æ•°æ®æµ
- é€‚åˆé«˜å¹¶å‘ã€å¤§ååé‡çš„åº”ç”¨åœºæ™¯
```

##### **ä¸åŒç½‘å¡ç±»å‹çš„è¾“å‡ºå¯¹æ¯”**

```bash
# ç¤ºä¾‹1: ä½ç«¯ç½‘å¡ï¼ˆå•é˜Ÿåˆ—ï¼‰
Channel parameters for eth1:
Pre-set maximums:
RX:             1    # æœ€å¤š1ä¸ªæ¥æ”¶é˜Ÿåˆ— (Receive)
TX:             1    # æœ€å¤š1ä¸ªå‘é€é˜Ÿåˆ— (Transmit)
Other:          0
Combined:       0
Current hardware settings:
RX:             1    # å½“å‰1ä¸ªæ¥æ”¶é˜Ÿåˆ—
TX:             1    # å½“å‰1ä¸ªå‘é€é˜Ÿåˆ—
Other:          0
Combined:       0

# ç¤ºä¾‹2: ä¸­ç«¯ç½‘å¡ï¼ˆåˆ†ç¦»é˜Ÿåˆ—ï¼‰
Channel parameters for eth2:
Pre-set maximums:
RX:             8    # æœ€å¤š8ä¸ªæ¥æ”¶é˜Ÿåˆ— (Receive)
TX:             8    # æœ€å¤š8ä¸ªå‘é€é˜Ÿåˆ— (Transmit)
Other:          1
Combined:       0
Current hardware settings:
RX:             4    # å½“å‰4ä¸ªæ¥æ”¶é˜Ÿåˆ—
TX:             4    # å½“å‰4ä¸ªå‘é€é˜Ÿåˆ—
Other:          1
Combined:       0

# ç¤ºä¾‹3: é«˜ç«¯ç½‘å¡ï¼ˆæ··åˆæ¨¡å¼ï¼‰
Channel parameters for eth3:
Pre-set maximums:
RX:             16   # æœ€å¤š16ä¸ªæ¥æ”¶é˜Ÿåˆ— (Receive)
TX:             16   # æœ€å¤š16ä¸ªå‘é€é˜Ÿåˆ— (Transmit)
Other:          1
Combined:       16   # æœ€å¤š16ä¸ªç»„åˆé˜Ÿåˆ— (æ—¢èƒ½RXåˆèƒ½TX)
Current hardware settings:
RX:             0    # å½“å‰ä¸ä½¿ç”¨ç‹¬ç«‹æ¥æ”¶é˜Ÿåˆ—
TX:             0    # å½“å‰ä¸ä½¿ç”¨ç‹¬ç«‹å‘é€é˜Ÿåˆ—
Other:          1
Combined:       16   # å½“å‰ä½¿ç”¨16ä¸ªç»„åˆé˜Ÿåˆ—
```

##### **é˜Ÿåˆ—é…ç½®ä¼˜åŒ–å»ºè®®**

```bash
# 1. æŸ¥çœ‹CPUæ ¸å¿ƒæ•°ï¼Œç¡®å®šåˆç†çš„é˜Ÿåˆ—æ•°é‡
nproc
# è¾“å‡º: 8 (å‡è®¾8æ ¸CPU)

# 2. æ ¹æ®å·¥ä½œè´Ÿè½½é€‰æ‹©é˜Ÿåˆ—é…ç½®
# æ¥æ”¶å¯†é›†å‹: æ›´å¤šRXé˜Ÿåˆ— (Receive Queue - æ¥æ”¶é˜Ÿåˆ—)
# ethtool -L eth0 rx 8 tx 4

# å‘é€å¯†é›†å‹: æ›´å¤šTXé˜Ÿåˆ— (Transmit Queue - å‘é€é˜Ÿåˆ—)
# ethtool -L eth0 rx 4 tx 8

# å‡è¡¡è´Ÿè½½: ä½¿ç”¨ç»„åˆé˜Ÿåˆ—
# ethtool -L eth0 combined 8

# 3. éªŒè¯é…ç½®
ethtool -l eth0
```

##### **è‡ªåŠ¨åŒ–é˜Ÿåˆ—åˆ†æè„šæœ¬**
```bash
#!/bin/bash
echo "=== ç½‘å¡é˜Ÿåˆ—é…ç½®åˆ†æå·¥å…· ==="

analyze_network_queues() {
    local interface=$1
    
    echo "åˆ†æç½‘å¡: $interface"
    echo "================================"
    
    # 1. è·å–é˜Ÿåˆ—ä¿¡æ¯
    if ! ethtool -l $interface &>/dev/null; then
        echo "  âŒ ä¸æ”¯æŒ ethtool é˜Ÿåˆ—æŸ¥è¯¢"
        return 1
    fi
    
    local ethtool_output=$(ethtool -l $interface)
    
    # è§£ææœ€å¤§å€¼
    local max_rx=$(echo "$ethtool_output" | grep -A5 "Pre-set maximums:" | grep "RX:" | awk '{print $2}')
    local max_tx=$(echo "$ethtool_output" | grep -A5 "Pre-set maximums:" | grep "TX:" | awk '{print $2}')
    local max_combined=$(echo "$ethtool_output" | grep -A5 "Pre-set maximums:" | grep "Combined:" | awk '{print $2}')
    local max_other=$(echo "$ethtool_output" | grep -A5 "Pre-set maximums:" | grep "Other:" | awk '{print $2}')
    
    # è§£æå½“å‰å€¼
    local cur_rx=$(echo "$ethtool_output" | grep -A5 "Current hardware settings:" | grep "RX:" | awk '{print $2}')
    local cur_tx=$(echo "$ethtool_output" | grep -A5 "Current hardware settings:" | grep "TX:" | awk '{print $2}')
    local cur_combined=$(echo "$ethtool_output" | grep -A5 "Current hardware settings:" | grep "Combined:" | awk '{print $2}')
    local cur_other=$(echo "$ethtool_output" | grep -A5 "Current hardware settings:" | grep "Other:" | awk '{print $2}')
    
    # 2. æ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯
    echo "  ğŸ“Š é˜Ÿåˆ—é…ç½®æ¦‚è§ˆ:"
    echo "    ä¸“ç”¨RXé˜Ÿåˆ— (Receive): $cur_rx/$max_rx (å½“å‰/æœ€å¤§)"
    echo "    ä¸“ç”¨TXé˜Ÿåˆ— (Transmit): $cur_tx/$max_tx (å½“å‰/æœ€å¤§)"
    echo "    ç»„åˆé˜Ÿåˆ— (RX+TX): $cur_combined/$max_combined (å½“å‰/æœ€å¤§)"
    echo "    å…¶ä»–é˜Ÿåˆ—: $cur_other/$max_other (å½“å‰/æœ€å¤§)"
    
    # 3. è®¡ç®—æ€»é˜Ÿåˆ—æ•°
    local total_queues=$((cur_rx + cur_tx + cur_combined))
    echo "    æ€»æ´»è·ƒé˜Ÿåˆ—: $total_queues"
    
    # 4. ç½‘å¡ç±»å‹åˆ¤æ–­
    echo "  ğŸ” ç½‘å¡ç±»å‹åˆ†æ:"
    if [ $max_combined -gt 0 ] && [ $cur_combined -gt 0 ]; then
        echo "    ç±»å‹: ç°ä»£å¤šé˜Ÿåˆ—ç½‘å¡ (ç»„åˆé˜Ÿåˆ—æ¨¡å¼)"
        echo "    ç‰¹ç‚¹: çµæ´»çš„RX/TXèµ„æºåˆ†é…"
    elif [ $max_rx -gt 1 ] || [ $max_tx -gt 1 ]; then
        echo "    ç±»å‹: åˆ†ç¦»é˜Ÿåˆ—ç½‘å¡"
        echo "    ç‰¹ç‚¹: ç‹¬ç«‹çš„RX/TXé˜Ÿåˆ—"
    else
        echo "    ç±»å‹: å•é˜Ÿåˆ—ç½‘å¡"
        echo "    ç‰¹ç‚¹: åŸºç¡€ç½‘ç»œåŠŸèƒ½"
    fi
    
    # 5. æ€§èƒ½è¯„ä¼°
    echo "  âš¡ æ€§èƒ½åˆ†æ:"
    local cpu_count=$(nproc)
    echo "    ç³»ç»ŸCPUæ ¸å¿ƒæ•°: $cpu_count"
    
    if [ $total_queues -ge $cpu_count ]; then
        echo "    é˜Ÿåˆ—é…ç½®: âœ… ä¼˜ç§€ (é˜Ÿåˆ—æ•° >= CPUæ ¸å¿ƒæ•°)"
    elif [ $total_queues -ge $((cpu_count / 2)) ]; then
        echo "    é˜Ÿåˆ—é…ç½®: âš ï¸  è‰¯å¥½ (é˜Ÿåˆ—æ•° >= CPUæ ¸å¿ƒæ•°/2)"
    else
        echo "    é˜Ÿåˆ—é…ç½®: âŒ éœ€ä¼˜åŒ– (é˜Ÿåˆ—æ•° < CPUæ ¸å¿ƒæ•°/2)"
    fi
    
    # 6. ä¼˜åŒ–å»ºè®®
    echo "  ğŸ’¡ ä¼˜åŒ–å»ºè®®:"
    if [ $max_combined -gt $cur_combined ] && [ $max_combined -gt 0 ]; then
        local optimal_combined=$([ $cpu_count -le $max_combined ] && echo $cpu_count || echo $max_combined)
        echo "    å»ºè®®è®¾ç½®ç»„åˆé˜Ÿåˆ—ä¸º: $optimal_combined"
        echo "    å‘½ä»¤: ethtool -L $interface combined $optimal_combined"
    elif [ $max_rx -gt $cur_rx ] || [ $max_tx -gt $cur_tx ]; then
        local optimal_rx=$([ $((cpu_count / 2)) -le $max_rx ] && echo $((cpu_count / 2)) || echo $max_rx)
        local optimal_tx=$([ $((cpu_count / 2)) -le $max_tx ] && echo $((cpu_count / 2)) || echo $max_tx)
        echo "    å»ºè®®è®¾ç½®RXé˜Ÿåˆ—ä¸º: $optimal_rx, TXé˜Ÿåˆ—ä¸º: $optimal_tx"
        echo "    å‘½ä»¤: ethtool -L $interface rx $optimal_rx tx $optimal_tx"
    else
        echo "    å½“å‰é…ç½®å·²optimal"
    fi
    
    # 7. ä¸­æ–­åˆ†å¸ƒæ£€æŸ¥
    echo "  ğŸ”„ ä¸­æ–­åˆ†å¸ƒ:"
    local irq_count=$(grep $interface /proc/interrupts 2>/dev/null | wc -l)
    if [ $irq_count -gt 0 ]; then
        echo "    ä¸­æ–­æ•°é‡: $irq_count"
        echo "    ä¸­æ–­è¯¦æƒ…:"
        grep $interface /proc/interrupts | head -3 | sed 's/^/      /'
        if [ $irq_count -gt 3 ]; then
            echo "      ... (å…± $irq_count ä¸ªä¸­æ–­)"
        fi
    else
        echo "    ä¸­æ–­ä¿¡æ¯: æœªæ‰¾åˆ°ç›¸å…³ä¸­æ–­"
    fi
    
    echo ""
}

# åˆ†ææ‰€æœ‰ç‰©ç†ç½‘å¡
echo "ğŸ” å¼€å§‹åˆ†æç³»ç»Ÿä¸­çš„ç½‘å¡é˜Ÿåˆ—é…ç½®..."
echo ""

for interface in $(ip link show | grep -E "^[0-9]+:" | cut -d: -f2 | awk '{print $1}'); do
    # è·³è¿‡è™šæ‹Ÿæ¥å£
    if [[ ! "$interface" =~ ^(lo|docker|br-|veth|virbr) ]]; then
        analyze_network_queues $interface
    fi
done

echo "âœ… åˆ†æå®Œæˆï¼"
```

##### **é˜Ÿåˆ—é…ç½®æœ€ä½³å®è·µ**

```bash
# 1. æ ¹æ®å·¥ä½œè´Ÿè½½ç±»å‹é€‰æ‹©é…ç½®
workload_optimization() {
    local interface=$1
    local workload_type=$2  # web_server, database, storage, general
    
    case $workload_type in
        "web_server")
            # WebæœåŠ¡å™¨: æ›´å¤šå‘é€é˜Ÿåˆ—
            echo "WebæœåŠ¡å™¨ä¼˜åŒ–: å‘é€å¯†é›†å‹ (æ›´å¤š TX/Transmit é˜Ÿåˆ—)"
            ethtool -L $interface tx 8 rx 4 2>/dev/null || \
            ethtool -L $interface combined 8 2>/dev/null
            ;;
        "database")
            # æ•°æ®åº“: å‡è¡¡é…ç½®
            echo "æ•°æ®åº“ä¼˜åŒ–: å‡è¡¡é…ç½® (RX/TX å¹³è¡¡)"
            ethtool -L $interface combined $(nproc) 2>/dev/null
            ;;
        "storage")
            # å­˜å‚¨æœåŠ¡: æ›´å¤šæ¥æ”¶é˜Ÿåˆ—
            echo "å­˜å‚¨æœåŠ¡ä¼˜åŒ–: æ¥æ”¶å¯†é›†å‹ (æ›´å¤š RX/Receive é˜Ÿåˆ—)"
            ethtool -L $interface rx 8 tx 4 2>/dev/null || \
            ethtool -L $interface combined 8 2>/dev/null
            ;;
        "general")
            # é€šç”¨é…ç½®
            echo "é€šç”¨ä¼˜åŒ–: å¹³è¡¡é…ç½® (Combined é˜Ÿåˆ—)"
            local cores=$(nproc)
            ethtool -L $interface combined $cores 2>/dev/null
            ;;
    esac
}

# ä½¿ç”¨ç¤ºä¾‹:
# workload_optimization eth0 web_server
# workload_optimization eth0 database
```

##### **ç½‘ç»œæœ¯è¯­ç¼©å†™å¯¹ç…§è¡¨**

| ç¼©å†™ | å…¨æ‹¼ | ä¸­æ–‡å«ä¹‰ | åŠŸèƒ½è¯´æ˜ |
|------|------|----------|----------|
| **RX** | **Receive** | æ¥æ”¶ | å¤„ç†ä»ç½‘ç»œæ¥æ”¶åˆ°çš„æ•°æ®åŒ… |
| **TX** | **Transmit** | å‘é€/ä¼ è¾“ | å¤„ç†å‘ç½‘ç»œå‘é€çš„æ•°æ®åŒ… |
| **Combined** | **Combined Queue** | ç»„åˆé˜Ÿåˆ— | åŒæ—¶å¤„ç†RXå’ŒTXçš„é˜Ÿåˆ— |
| **RSS** | **Receive Side Scaling** | æ¥æ”¶ç«¯æ‰©å±• | å°†æ¥æ”¶è´Ÿè½½åˆ†æ•£åˆ°å¤šä¸ªCPU |
| **RPS** | **Receive Packet Steering** | æ¥æ”¶åŒ…è°ƒåº¦ | è½¯ä»¶å±‚é¢çš„æ¥æ”¶è´Ÿè½½å‡è¡¡ |
| **RFS** | **Receive Flow Steering** | æ¥æ”¶æµè°ƒåº¦ | åŸºäºè¿æ¥çš„æ¥æ”¶è´Ÿè½½å‡è¡¡ |
| **XPS** | **Transmit Packet Steering** | å‘é€åŒ…è°ƒåº¦ | å‘é€ç«¯çš„è´Ÿè½½å‡è¡¡ |
| **IRQ** | **Interrupt Request** | ä¸­æ–­è¯·æ±‚ | ç¡¬ä»¶ä¸­æ–­ä¿¡å· |
| **NAPI** | **New API** | æ–°API | Linuxç½‘ç»œå¤„ç†çš„è½®è¯¢æœºåˆ¶ |

##### **æ•°æ®æµå‘ç†è§£**
```
ç½‘ç»œæ•°æ®åŒ…æµå‘ç¤ºæ„:

å¤–éƒ¨ç½‘ç»œ â”€â”€RX(æ¥æ”¶)â”€â”€â†’ ç½‘å¡é˜Ÿåˆ— â”€â”€â†’ CPUå¤„ç† â”€â”€â†’ åº”ç”¨ç¨‹åº
                   â†‘
                 ç¡¬ä»¶ä¸­æ–­
                   
åº”ç”¨ç¨‹åº â”€â”€â†’ CPUå¤„ç† â”€â”€â†’ ç½‘å¡é˜Ÿåˆ— â”€â”€TX(å‘é€)â”€â”€â†’ å¤–éƒ¨ç½‘ç»œ
                        â†‘
                      è½¯ä»¶è°ƒåº¦

è¯´æ˜:
- RX (Receive): ç½‘ç»œ â†’ ç³»ç»Ÿ (æ¥æ”¶æ–¹å‘)
- TX (Transmit): ç³»ç»Ÿ â†’ ç½‘ç»œ (å‘é€æ–¹å‘)
- Combined: é˜Ÿåˆ—å¯ä»¥åŒæ—¶å¤„ç†ä¸¤ä¸ªæ–¹å‘
```

##### **æ–¹æ³•2: é€šè¿‡ /sys æ–‡ä»¶ç³»ç»ŸæŸ¥è¯¢**
```bash
# æŸ¥çœ‹ç½‘å¡çš„å‘é€é˜Ÿåˆ—æ•°é‡
cat /sys/class/net/eth0/queues/tx-*/tx_timeout 2>/dev/null | wc -l

# æŸ¥çœ‹ç½‘å¡çš„æ¥æ”¶é˜Ÿåˆ—æ•°é‡  
ls /sys/class/net/eth0/queues/rx-* 2>/dev/null | wc -l

# æ‰¹é‡æŸ¥çœ‹æ‰€æœ‰ç½‘å¡çš„é˜Ÿåˆ—ä¿¡æ¯
for iface in $(ls /sys/class/net/); do
    tx_queues=$(ls /sys/class/net/$iface/queues/tx-* 2>/dev/null | wc -l)
    rx_queues=$(ls /sys/class/net/$iface/queues/rx-* 2>/dev/null | wc -l)
    if [ $tx_queues -gt 0 ] || [ $rx_queues -gt 0 ]; then
        echo "$iface: TXé˜Ÿåˆ—=$tx_queues, RXé˜Ÿåˆ—=$rx_queues"
    fi
done
```

##### **æ–¹æ³•3: ä½¿ç”¨ tc æŸ¥çœ‹é˜Ÿåˆ—è°ƒåº¦å™¨**
```bash
# æŸ¥çœ‹ä½¿ç”¨ mq è°ƒåº¦å™¨çš„æ¥å£
tc qdisc show | grep "qdisc mq"

# æŸ¥çœ‹ mq è°ƒåº¦å™¨çš„å­é˜Ÿåˆ—è¯¦æƒ…
tc class show dev eth0 | grep "class mq"

# ç»Ÿè®¡ mq è°ƒåº¦å™¨ç®¡ç†çš„é˜Ÿåˆ—æ•°é‡
tc class show dev eth0 | grep "class mq" | wc -l
```

##### **æ–¹æ³•4: ç»¼åˆé˜Ÿåˆ—ä¿¡æ¯æŸ¥è¯¢è„šæœ¬**
```bash
#!/bin/bash
echo "=== ç½‘å¡é˜Ÿåˆ—ä¿¡æ¯è¯¦ç»†æŸ¥è¯¢ ==="

check_interface_queues() {
    local iface=$1
    echo "æ¥å£: $iface"
    
    # 1. æ£€æŸ¥æ˜¯å¦æ”¯æŒ ethtool
    if ethtool -l $iface &>/dev/null; then
        echo "  ç¡¬ä»¶é˜Ÿåˆ—ä¿¡æ¯ (ethtool):"
        ethtool -l $iface | grep -E "(RX:|TX:|Combined:)" | sed 's/^/    /'
    fi
    
    # 2. æ£€æŸ¥ /sys æ–‡ä»¶ç³»ç»Ÿä¸­çš„é˜Ÿåˆ—
    local tx_count=$(ls /sys/class/net/$iface/queues/tx-* 2>/dev/null | wc -l)
    local rx_count=$(ls /sys/class/net/$iface/queues/rx-* 2>/dev/null | wc -l)
    echo "  ç³»ç»Ÿé˜Ÿåˆ—æ–‡ä»¶:"
    echo "    TXé˜Ÿåˆ—: $tx_count"
    echo "    RXé˜Ÿåˆ—: $rx_count"
    
    # 3. æ£€æŸ¥å½“å‰çš„é˜Ÿåˆ—è°ƒåº¦å™¨
    local qdisc=$(tc qdisc show dev $iface 2>/dev/null | head -1 | awk '{print $2}')
    echo "  å½“å‰é˜Ÿåˆ—è°ƒåº¦å™¨: $qdisc"
    
    # 4. å¦‚æœæ˜¯ mqï¼Œæ˜¾ç¤ºå­é˜Ÿåˆ—
    if [[ "$qdisc" == "mq" ]]; then
        local mq_classes=$(tc class show dev $iface 2>/dev/null | grep "class mq" | wc -l)
        echo "  mq å­é˜Ÿåˆ—æ•°é‡: $mq_classes"
        
        # æ˜¾ç¤ºæ¯ä¸ªå­é˜Ÿåˆ—çš„ç»Ÿè®¡
        echo "  å­é˜Ÿåˆ—ç»Ÿè®¡:"
        tc -s class show dev $iface 2>/dev/null | grep -A2 "class mq" | sed 's/^/    /'
    fi
    
    echo ""
}

# æ£€æŸ¥æ‰€æœ‰ç½‘ç»œæ¥å£
for iface in $(ip link show | grep "^[0-9]" | cut -d: -f2 | awk '{print $1}'); do
    # è·³è¿‡å›ç¯æ¥å£
    if [[ "$iface" != "lo" ]]; then
        check_interface_queues $iface
    fi
done
```

##### **æ–¹æ³•5: å®æ—¶ç›‘æ§é˜Ÿåˆ—æ€§èƒ½**
```bash
# ç›‘æ§å¤šé˜Ÿåˆ—ç½‘å¡çš„æ¯ä¸ªé˜Ÿåˆ—ç»Ÿè®¡
watch -n 1 'tc -s class show dev eth0 | grep -A2 "class mq"'

# æŸ¥çœ‹æ¯ä¸ªCPUçš„ç½‘ç»œä¸­æ–­åˆ†å¸ƒ
cat /proc/interrupts | grep eth0

# æŸ¥çœ‹ç½‘å¡ä¸­æ–­çš„CPUäº²å’Œæ€§
for irq in $(grep eth0 /proc/interrupts | cut -d: -f1); do
    echo "IRQ $irq çš„CPUäº²å’Œæ€§: $(cat /proc/irq/$irq/smp_affinity_list 2>/dev/null || echo 'æœªè®¾ç½®')"
done

# æŸ¥çœ‹RPS/RFSé…ç½®ï¼ˆæ¥æ”¶åŒ…è°ƒåº¦ï¼‰
echo "RPSé…ç½® (æ¥æ”¶åŒ…è°ƒåº¦åˆ°å¤šä¸ªCPU):"
for queue in /sys/class/net/eth0/queues/rx-*/rps_cpus; do
    if [ -f "$queue" ]; then
        echo "  $(basename $(dirname $queue)): $(cat $queue)"
    fi
done
```

#### **é˜Ÿåˆ—æ•°é‡ä¸æ€§èƒ½çš„å…³ç³»**

##### **å¤šé˜Ÿåˆ—çš„ä¼˜åŠ¿**
```bash
# ä¼˜åŠ¿è¯´æ˜:
- å¹¶è¡Œå¤„ç†: æ¯ä¸ªCPUæ ¸å¿ƒå¤„ç†ç‹¬ç«‹çš„é˜Ÿåˆ—
- å‡å°‘é”ç«äº‰: é¿å…å¤šä¸ªCPUäº‰ç”¨åŒä¸€ä¸ªé˜Ÿåˆ—
- æé«˜ååé‡: å……åˆ†åˆ©ç”¨å¤šæ ¸æ¶æ„
- é™ä½å»¶è¿Ÿ: å‡å°‘é˜Ÿåˆ—ç­‰å¾…æ—¶é—´

# é€‚ç”¨åœºæ™¯:
- é«˜å¹¶å‘ç½‘ç»œåº”ç”¨
- å¤§æµé‡æ•°æ®ä¼ è¾“
- å¤šæ ¸å¿ƒæœåŠ¡å™¨
- ç½‘ç»œå¯†é›†å‹å·¥ä½œè´Ÿè½½
```

##### **é˜Ÿåˆ—é…ç½®å»ºè®®**
```bash
# ä¸€èˆ¬é…ç½®åŸåˆ™:
- é˜Ÿåˆ—æ•°é‡é€šå¸¸ç­‰äºæˆ–å°äºCPUæ ¸å¿ƒæ•°
- é¿å…è¿‡å¤šé˜Ÿåˆ—å¯¼è‡´ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€
- è€ƒè™‘ç½‘å¡ç¡¬ä»¶æ”¯æŒçš„æœ€å¤§é˜Ÿåˆ—æ•°
- æ ¹æ®å®é™…å·¥ä½œè´Ÿè½½è°ƒæ•´

# æŸ¥çœ‹å½“å‰ç³»ç»ŸCPUæ ¸å¿ƒæ•°
nproc

# æŸ¥çœ‹CPUä¿¡æ¯
lscpu | grep "CPU(s):"

# å»ºè®®çš„é˜Ÿåˆ—æ•°é‡è®¡ç®—
echo "CPUæ ¸å¿ƒæ•°: $(nproc)"
echo "å»ºè®®é˜Ÿåˆ—æ•°: $(echo "$(nproc) / 2" | bc) åˆ° $(nproc)"
```

#### **å®é™…åº”ç”¨ç¤ºä¾‹**
```bash
#!/bin/bash
echo "=== qdisc å®é™…åº”ç”¨æ¼”ç¤º ==="

# åˆ›å»ºæµ‹è¯•ç¯å¢ƒ
ip netns add qdisc-test
ip link add veth-qdisc type veth peer name veth-qdisc-ns
ip link set veth-qdisc-ns netns qdisc-test

echo "1. æŸ¥çœ‹é»˜è®¤ qdisc:"
tc qdisc show dev veth-qdisc

echo "2. ä¿®æ”¹ä¸º nop é˜Ÿåˆ—:"
tc qdisc replace dev veth-qdisc root nop
tc qdisc show dev veth-qdisc

echo "3. æ¢å¤ä¸º pfifo_fast:"
tc qdisc replace dev veth-qdisc root pfifo_fast
tc qdisc show dev veth-qdisc

echo "4. namespace å†…çš„é˜Ÿåˆ—è§„åˆ™:"
ip netns exec qdisc-test tc qdisc show dev veth-qdisc-ns

# æ¸…ç†
ip netns delete qdisc-test
```

#### **Network Namespace ä¸­çš„é˜Ÿåˆ—é…ç½®æµ‹è¯•**
```bash
#!/bin/bash
echo "=== Network Namespace é˜Ÿåˆ—é…ç½®å¯¹æ¯”æµ‹è¯• ==="

# åˆ›å»ºæµ‹è¯•ç¯å¢ƒ
ip netns add queue-test
ip link add veth-main type veth peer name veth-ns
ip link set veth-ns netns queue-test

echo "1. ä¸»æœºä¾§ veth æ¥å£é˜Ÿåˆ—ä¿¡æ¯:"
echo "æ¥å£: veth-main"
echo "  é˜Ÿåˆ—è°ƒåº¦å™¨: $(tc qdisc show dev veth-main | head -1 | awk '{print $2}')"
echo "  TXé˜Ÿåˆ—æ•°: $(ls /sys/class/net/veth-main/queues/tx-* 2>/dev/null | wc -l)"
echo "  RXé˜Ÿåˆ—æ•°: $(ls /sys/class/net/veth-main/queues/rx-* 2>/dev/null | wc -l)"

echo -e "\n2. Namespace ä¾§ veth æ¥å£é˜Ÿåˆ—ä¿¡æ¯:"
ip netns exec queue-test bash -c '
echo "æ¥å£: veth-ns"
echo "  é˜Ÿåˆ—è°ƒåº¦å™¨: $(tc qdisc show dev veth-ns | head -1 | awk "{print \$2}")"
echo "  TXé˜Ÿåˆ—æ•°: $(ls /sys/class/net/veth-ns/queues/tx-* 2>/dev/null | wc -l)"
echo "  RXé˜Ÿåˆ—æ•°: $(ls /sys/class/net/veth-ns/queues/rx-* 2>/dev/null | wc -l)"
'

echo -e "\n3. å¯¹æ¯”ç‰©ç†ç½‘å¡çš„é˜Ÿåˆ—é…ç½®:"
for iface in $(ip link show | grep "^[0-9]" | cut -d: -f2 | awk '{print $1}'); do
    if [[ "$iface" != "lo" ]] && [[ "$iface" != "veth-main" ]] && [[ ! "$iface" =~ ^(docker|br-) ]]; then
        echo "ç‰©ç†ç½‘å¡: $iface"
        qdisc=$(tc qdisc show dev $iface 2>/dev/null | head -1 | awk '{print $2}')
        tx_queues=$(ls /sys/class/net/$iface/queues/tx-* 2>/dev/null | wc -l)
        rx_queues=$(ls /sys/class/net/$iface/queues/rx-* 2>/dev/null | wc -l)
        echo "  é˜Ÿåˆ—è°ƒåº¦å™¨: $qdisc"
        echo "  TXé˜Ÿåˆ—æ•°: $tx_queues"
        echo "  RXé˜Ÿåˆ—æ•°: $rx_queues"
        
        # å¦‚æœæ”¯æŒ ethtoolï¼Œæ˜¾ç¤ºç¡¬ä»¶ä¿¡æ¯
        if ethtool -l $iface &>/dev/null; then
            echo "  ç¡¬ä»¶é˜Ÿåˆ—ä¿¡æ¯:"
            ethtool -l $iface | grep -E "(Current|RX:|TX:|Combined:)" | sed 's/^/    /'
        fi
        break  # åªæ˜¾ç¤ºç¬¬ä¸€ä¸ªç‰©ç†ç½‘å¡
    fi
done

echo -e "\n4. æµ‹è¯•é˜Ÿåˆ—è°ƒåº¦å™¨ä¿®æ”¹:"
echo "åŸå§‹è°ƒåº¦å™¨: $(tc qdisc show dev veth-main | head -1)"

# å°è¯•ä¿®æ”¹ä¸ºä¸åŒçš„è°ƒåº¦å™¨
echo "ä¿®æ”¹ä¸º fq è°ƒåº¦å™¨:"
tc qdisc replace dev veth-main root fq
echo "ä¿®æ”¹å: $(tc qdisc show dev veth-main | head -1)"

echo "æ¢å¤ä¸ºé»˜è®¤è°ƒåº¦å™¨:"
tc qdisc delete dev veth-main root 2>/dev/null
echo "æ¢å¤å: $(tc qdisc show dev veth-main | head -1)"

# æ¸…ç†
ip netns delete queue-test
echo -e "\næµ‹è¯•ç¯å¢ƒå·²æ¸…ç†"
```

#### **å¤šé˜Ÿåˆ—ç½‘å¡æ€§èƒ½ä¼˜åŒ–å»ºè®®**

##### **1. é˜Ÿåˆ—æ•°é‡ä¼˜åŒ–**
```bash
# æŸ¥çœ‹å½“å‰ç½‘å¡æ”¯æŒçš„æœ€å¤§é˜Ÿåˆ—æ•°
ethtool -l eth0

# è®¾ç½®é˜Ÿåˆ—æ•°é‡ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
# ethtool -L eth0 combined 4

# éªŒè¯è®¾ç½®
ethtool -l eth0 | grep "Current"
```

##### **2. ä¸­æ–­äº²å’Œæ€§ä¼˜åŒ–**
```bash
# æŸ¥çœ‹ç½‘å¡ä¸­æ–­åˆ†å¸ƒ
grep eth0 /proc/interrupts

# è®¾ç½®ä¸­æ–­äº²å’Œæ€§ï¼ˆå°†ä¸åŒé˜Ÿåˆ—çš„ä¸­æ–­åˆ†é…ç»™ä¸åŒCPUï¼‰
# echo 1 > /proc/irq/24/smp_affinity_list  # é˜Ÿåˆ—0ç»‘å®šåˆ°CPU0
# echo 2 > /proc/irq/25/smp_affinity_list  # é˜Ÿåˆ—1ç»‘å®šåˆ°CPU1

# è‡ªåŠ¨åŒ–è„šæœ¬ï¼šå¹³å‡åˆ†é…ä¸­æ–­åˆ°æ‰€æœ‰CPU
#!/bin/bash
setup_irq_affinity() {
    local interface=$1
    local cpu_count=$(nproc)
    local cpu_index=0
    
    for irq in $(grep $interface /proc/interrupts | cut -d: -f1 | tr -d ' '); do
        echo $cpu_index > /proc/irq/$irq/smp_affinity_list
        echo "IRQ $irq -> CPU $cpu_index"
        cpu_index=$(( (cpu_index + 1) % cpu_count ))
    done
}

# ä½¿ç”¨ç¤ºä¾‹ï¼ˆéœ€è¦rootæƒé™ï¼‰
# setup_irq_affinity eth0
```

##### **3. æ¥æ”¶åŒ…è°ƒåº¦(RPS)é…ç½®**
```bash
# å¯ç”¨RPSï¼Œå°†æ¥æ”¶åŒ…åˆ†å‘åˆ°å¤šä¸ªCPU
for queue in /sys/class/net/eth0/queues/rx-*/rps_cpus; do
    if [ -f "$queue" ]; then
        # è®¾ç½®æ‰€æœ‰CPUéƒ½å¯ä»¥å¤„ç†æ¥æ”¶åŒ… (åå…­è¿›åˆ¶æ©ç )
        echo $(printf '%x' $((2**$(nproc) - 1))) > "$queue"
        echo "å·²ä¸º $(basename $(dirname $queue)) å¯ç”¨RPS"
    fi
done

# æŸ¥çœ‹RPSé…ç½®çŠ¶æ€
echo "å½“å‰RPSé…ç½®:"
for queue in /sys/class/net/eth0/queues/rx-*/rps_cpus; do
    if [ -f "$queue" ]; then
        echo "  $(basename $(dirname $queue)): $(cat $queue)"
    fi
done
```

#### **å­—æ®µè§£æå®è·µç¤ºä¾‹**
```bash
#!/bin/bash
echo "=== ip addr show ç¬¬ä¸€è¡Œå­—æ®µè¯¦ç»†è§£æç¤ºä¾‹ ==="

# åˆ›å»ºæµ‹è¯•ç¯å¢ƒ
ip netns add field-demo
ip link add veth-demo type veth peer name veth-demo-ns
ip link set veth-demo-ns netns field-demo

echo "1. è§£æä¸»æœºä¾§ veth æ¥å£ï¼š"
interface_line=$(ip link show veth-demo | head -1)
echo "åŸå§‹è¾“å‡º: $interface_line"

# è§£æå„ä¸ªå­—æ®µ
index=$(echo "$interface_line" | cut -d: -f1)
name=$(echo "$interface_line" | cut -d: -f2 | awk '{print $1}')
flags=$(echo "$interface_line" | grep -o '<[^>]*>')
mtu=$(echo "$interface_line" | grep -o 'mtu [0-9]*' | cut -d' ' -f2)
qdisc=$(echo "$interface_line" | grep -o 'qdisc [a-z_]*' | cut -d' ' -f2)
state=$(echo "$interface_line" | grep -o 'state [A-Z]*' | cut -d' ' -f2)
group=$(echo "$interface_line" | grep -o 'group [a-z0-9]*' | cut -d' ' -f2)
qlen=$(echo "$interface_line" | grep -o 'qlen [0-9]*' | cut -d' ' -f2)

echo "  ç´¢å¼•å·: $index"
echo "  æ¥å£å: $name"
echo "  æ ‡å¿—ä½: $flags"
echo "  MTU: $mtu å­—èŠ‚"
echo "  é˜Ÿåˆ—è§„åˆ™: $qdisc"
echo "  çŠ¶æ€: $state"
echo "  æ¥å£ç»„: $group"
echo "  é˜Ÿåˆ—é•¿åº¦: $qlen"

echo -e "\n2. é…ç½®æ¥å£å¹¶è§‚å¯Ÿå˜åŒ–ï¼š"
# å¯ç”¨æ¥å£
ip link set veth-demo up
echo "å¯ç”¨æ¥å£å:"
ip link show veth-demo | head -1

# ä¿®æ”¹ MTU
ip link set veth-demo mtu 1400
echo "ä¿®æ”¹ MTU å:"
ip link show veth-demo | head -1

# æ¸…ç†
ip netns delete field-demo
ip link delete veth-demo 2>/dev/null || true
```

### ğŸ“Š ç¬¬ä¸€è¡Œå­—æ®µå¯¹æ¯”è¡¨

| å­—æ®µ | ç¤ºä¾‹å€¼ | å«ä¹‰ | å¯è°ƒæ•´ | å¸¸è§é—®é¢˜ |
|------|--------|------|--------|----------|
| **ç´¢å¼•å·** | `1:` | ç³»ç»Ÿåˆ†é…çš„å”¯ä¸€ID | âŒ | æ¥å£åˆ é™¤åå¯èƒ½é‡ç”¨ |
| **æ¥å£å** | `eth0:` | äººç±»å¯è¯»çš„æ¥å£æ ‡è¯† | âœ… | æœ€å¤§15å­—ç¬¦é™åˆ¶ |
| **æ ‡å¿—ä½** | `<UP,LOWER_UP>` | æ¥å£çŠ¶æ€å’Œç‰¹æ€§ | âœ… | UPä½†æ— LOWER_UPè¡¨ç¤ºç‰©ç†å±‚é—®é¢˜ |
| **MTU** | `mtu 1500` | æœ€å¤§ä¼ è¾“å•å…ƒ(å­—èŠ‚) | âœ… | è®¾ç½®è¿‡å¤§å¯èƒ½å¯¼è‡´åˆ†ç‰‡ |
| **é˜Ÿåˆ—è§„åˆ™** | `qdisc pfifo_fast` | æ•°æ®åŒ…è°ƒåº¦ç®—æ³• | âœ… | noqueueé€‚ç”¨äºè™šæ‹Ÿæ¥å£ |
| **çŠ¶æ€** | `state UP` | æ“ä½œçŠ¶æ€ | âŒ | ä¸æ ‡å¿—ä½UPå«ä¹‰ä¸åŒ |
| **æ¥å£ç»„** | `group default` | æ¥å£åˆ†ç»„ç®¡ç† | âœ… | ç”¨äºæ‰¹é‡æ“ä½œ |
| **é˜Ÿåˆ—é•¿åº¦** | `qlen 1000` | å‘é€é˜Ÿåˆ—å®¹é‡ | âœ… | å½±å“ç½‘ç»œæ€§èƒ½å’Œå†…å­˜ä½¿ç”¨ |

### ğŸ”§ å­—æ®µä¿®æ”¹å‘½ä»¤é€ŸæŸ¥

```bash
# ä¿®æ”¹æ¥å£åç§°
ip link set eth0 name new-name

# ä¿®æ”¹ MTU
ip link set eth0 mtu 9000

# ä¿®æ”¹é˜Ÿåˆ—è§„åˆ™
tc qdisc replace dev eth0 root fq

# ä¿®æ”¹é˜Ÿåˆ—é•¿åº¦
ip link set eth0 qlen 2000

# è®¾ç½®æ¥å£ç»„
ip link set eth0 group 1

# å¯ç”¨/ç¦ç”¨æ¥å£
ip link set eth0 up
ip link set eth0 down

# è®¾ç½®æ··æ‚æ¨¡å¼
ip link set eth0 promisc on

# ä¿®æ”¹ MAC åœ°å€
ip link set eth0 address 02:01:02:03:04:05
```

#### **ç¬¬äºŒè¡Œï¼šé“¾è·¯å±‚ä¿¡æ¯**
```
link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff
```

**å­—æ®µè§£æï¼š**
- **`link/loopback`** - é“¾è·¯ç±»å‹ï¼ˆå›ç¯æ¥å£ï¼‰
- **`link/ether`** - é“¾è·¯ç±»å‹ï¼ˆä»¥å¤ªç½‘æ¥å£ï¼‰
- **`02:42:ac:11:00:02`** - MACåœ°å€ï¼ˆç¡¬ä»¶åœ°å€ï¼‰
- **`brd ff:ff:ff:ff:ff:ff`** - å¹¿æ’­åœ°å€

**å¸¸è§é“¾è·¯ç±»å‹ï¼š**
```bash
link/loopback   - å›ç¯æ¥å£
link/ether      - ä»¥å¤ªç½‘æ¥å£
link/none       - ç‚¹å¯¹ç‚¹æ¥å£
link/tunnel     - éš§é“æ¥å£
link/bridge     - ç½‘æ¡¥æ¥å£
link/veth       - è™šæ‹Ÿä»¥å¤ªç½‘å¯¹
```

#### **ç¬¬ä¸‰è¡Œï¼šIPv4åœ°å€ä¿¡æ¯**
```
inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0
```

**å­—æ®µè§£æï¼š**
- **`inet`** - IPv4åœ°å€æ ‡è¯†
- **`172.17.0.2/16`** - IPåœ°å€å’Œå­ç½‘æ©ç ï¼ˆCIDRæ ¼å¼ï¼‰
- **`brd 172.17.255.255`** - å¹¿æ’­åœ°å€
- **`scope global`** - åœ°å€ä½œç”¨åŸŸ
- **`eth0`** - å…³è”çš„æ¥å£å

**åœ°å€ä½œç”¨åŸŸè¯¦è§£ï¼š**
```bash
scope host     - ä¸»æœºä½œç”¨åŸŸï¼ˆåªåœ¨æœ¬æœºæœ‰æ•ˆï¼Œå¦‚127.0.0.1ï¼‰
scope link     - é“¾è·¯ä½œç”¨åŸŸï¼ˆåªåœ¨æœ¬åœ°ç½‘ç»œæœ‰æ•ˆï¼Œå¦‚169.254.x.xï¼‰
scope global   - å…¨å±€ä½œç”¨åŸŸï¼ˆå¯ä»¥è·¯ç”±åˆ°å…¶ä»–ç½‘ç»œï¼‰
scope site     - ç«™ç‚¹ä½œç”¨åŸŸï¼ˆIPv6ä¸“ç”¨ï¼‰
```

#### **ç¬¬å››è¡Œï¼šåœ°å€ç”Ÿå‘½å‘¨æœŸ**
```
valid_lft forever preferred_lft forever
```

**å­—æ®µè§£æï¼š**
- **`valid_lft`** - åœ°å€æœ‰æ•ˆç”Ÿå‘½å‘¨æœŸ
- **`preferred_lft`** - åœ°å€é¦–é€‰ç”Ÿå‘½å‘¨æœŸ
- **`forever`** - æ°¸ä¹…æœ‰æ•ˆ
- ä¹Ÿå¯èƒ½æ˜¾ç¤ºå…·ä½“æ—¶é—´ï¼Œå¦‚ï¼š`valid_lft 3600sec preferred_lft 1800sec`

#### **IPv6åœ°å€ä¿¡æ¯**
```
inet6 fe80::42:acff:fe11:2/64 scope link
```

**å­—æ®µè§£æï¼š**
- **`inet6`** - IPv6åœ°å€æ ‡è¯†
- **`fe80::42:acff:fe11:2/64`** - IPv6åœ°å€å’Œå‰ç¼€é•¿åº¦
- **`scope link`** - é“¾è·¯æœ¬åœ°åœ°å€ä½œç”¨åŸŸ

### ğŸ› ï¸ å®ç”¨è§£æå‘½ä»¤

#### 1. è§£æç‰¹å®šå­—æ®µ
```bash
# åªæ˜¾ç¤ºæ¥å£åå’ŒIPåœ°å€
ip addr show | grep -E "^[0-9]+:|inet " | sed 'N;s/\n/ /'

# åªæ˜¾ç¤ºIPv4åœ°å€
ip addr show | grep "inet " | awk '{print $2}'

# åªæ˜¾ç¤ºMACåœ°å€
ip addr show | grep "link/ether" | awk '{print $2}'

# æ˜¾ç¤ºæ¥å£çŠ¶æ€
ip addr show | grep -E "^[0-9]+:" | grep -o "state [A-Z]*"
```

#### 2. æ ¼å¼åŒ–è¾“å‡ºç¤ºä¾‹
```bash
#!/bin/bash
echo "=== ç½‘ç»œæ¥å£è¯¦ç»†ä¿¡æ¯è§£æ ==="

ip addr show | while IFS= read -r line; do
    if [[ $line =~ ^[0-9]+: ]]; then
        # è§£ææ¥å£åŸºæœ¬ä¿¡æ¯
        iface_info=$(echo "$line" | cut -d: -f2 | sed 's/^ *//')
        iface_name=$(echo "$iface_info" | awk '{print $1}')
        flags=$(echo "$line" | grep -o '<[^>]*>')
        mtu=$(echo "$line" | grep -o 'mtu [0-9]*' | cut -d' ' -f2)
        state=$(echo "$line" | grep -o 'state [A-Z]*' | cut -d' ' -f2)
        
        echo ""
        echo "æ¥å£: $iface_name"
        echo "  æ ‡å¿—: $flags"
        echo "  MTU: $mtu"
        echo "  çŠ¶æ€: $state"
        
    elif [[ $line =~ link/ ]]; then
        # è§£æé“¾è·¯å±‚ä¿¡æ¯
        link_type=$(echo "$line" | awk '{print $1}')
        mac_addr=$(echo "$line" | awk '{print $2}')
        echo "  é“¾è·¯ç±»å‹: $link_type"
        echo "  MACåœ°å€: $mac_addr"
        
    elif [[ $line =~ inet ]]; then
        # è§£æIPåœ°å€ä¿¡æ¯
        ip_addr=$(echo "$line" | awk '{print $2}')
        scope=$(echo "$line" | grep -o 'scope [a-z]*' | cut -d' ' -f2)
        echo "  IPåœ°å€: $ip_addr (ä½œç”¨åŸŸ: $scope)"
    fi
done
```

### ğŸ”¬ åœ¨ Network Namespace ä¸­çš„å®é™…åº”ç”¨

#### å¯¹æ¯”ä¸åŒç¯å¢ƒçš„è¾“å‡º
```bash
#!/bin/bash
echo "=== ip addr show åœ¨ä¸åŒç¯å¢ƒä¸­çš„å¯¹æ¯” ==="

# åˆ›å»ºæµ‹è¯•ç¯å¢ƒ
ip netns add addr-test
ip link add veth-test type veth peer name veth-test-ns
ip link set veth-test-ns netns addr-test

# é…ç½®ç½‘ç»œ
ip addr add 10.1.1.1/24 dev veth-test
ip link set veth-test up

ip netns exec addr-test ip addr add 10.1.1.2/24 dev veth-test-ns
ip netns exec addr-test ip link set veth-test-ns up
ip netns exec addr-test ip link set lo up

echo "1. ä¸»æœºç¯å¢ƒçš„ç½‘ç»œæ¥å£:"
ip addr show veth-test

echo -e "\n2. Namespace ç¯å¢ƒçš„ç½‘ç»œæ¥å£:"
ip netns exec addr-test ip addr show

echo -e "\n3. è§£æå…³é”®å·®å¼‚:"
echo "ä¸»æœº veth-test çŠ¶æ€:"
ip addr show veth-test | grep "state" | grep -o "state [A-Z]*"

echo "Namespace veth-test-ns çŠ¶æ€:"
ip netns exec addr-test ip addr show veth-test-ns | grep "state" | grep -o "state [A-Z]*"

# æ¸…ç†
ip netns delete addr-test
```

### ğŸ“Š å¸¸è§çŠ¶æ€ç»„åˆå«ä¹‰

| çŠ¶æ€ç»„åˆ | å«ä¹‰ | å…¸å‹åœºæ™¯ |
|---------|------|----------|
| `<UP,LOWER_UP>` | æ¥å£æ­£å¸¸å·¥ä½œ | æ­£å¸¸çš„ç½‘ç»œæ¥å£ |
| `<UP>` ä½†æ—  `LOWER_UP` | ç®¡ç†å¯ç”¨ä½†ç‰©ç†å±‚æ–­å¼€ | ç½‘çº¿æœªæ’æˆ–å¯¹ç«¯æœªå¯ç”¨ |
| `<BROADCAST,MULTICAST,UP,LOWER_UP>` | ä»¥å¤ªç½‘æ¥å£æ­£å¸¸ | æ ‡å‡†ä»¥å¤ªç½‘æ¥å£ |
| `<LOOPBACK,UP,LOWER_UP>` | å›ç¯æ¥å£æ­£å¸¸ | æœ¬æœºå›ç¯æ¥å£ |
| `<POINTOPOINT,NOARP,UP,LOWER_UP>` | ç‚¹å¯¹ç‚¹æ¥å£ | VPNéš§é“ã€PPPè¿æ¥ |
| `<NO-CARRIER>` | æ— è½½æ³¢ä¿¡å· | ç‰©ç†è¿æ¥é—®é¢˜ |

## ğŸš¨ æ•…éšœæ’æŸ¥å‘½ä»¤

### ç½‘ç»œé—®é¢˜è¯Šæ–­
```bash
# 1. æ£€æŸ¥ namespace æ˜¯å¦å­˜åœ¨
ip netns list | grep your-namespace

# 2. æ£€æŸ¥ç½‘ç»œæ¥å£çŠ¶æ€
ip netns exec your-namespace ip link show

# 3. æ£€æŸ¥ IP åœ°å€é…ç½®
ip netns exec your-namespace ip addr show

# 4. æ£€æŸ¥è·¯ç”±è¡¨
ip netns exec your-namespace ip route show

# 5. æ£€æŸ¥ ARP è¡¨
ip netns exec your-namespace ip neigh show

# 6. æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
ip netns exec your-namespace ping -c 1 target-ip

# 7. æ£€æŸ¥ç«¯å£ç›‘å¬çŠ¶æ€
ip netns exec your-namespace netstat -tlnp

# 8. æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
ip netns exec your-namespace iptables -L -n

# 9. æŸ¥çœ‹ç½‘ç»œç»Ÿè®¡
ip netns exec your-namespace cat /proc/net/dev

# 10. æ£€æŸ¥ç½‘ç»œå‘½åç©ºé—´æŒ‚è½½ç‚¹
ls -la /var/run/netns/
```

## ğŸ§¹ æ¸…ç†è„šæœ¬

```bash
#!/bin/bash
echo "=== æ¸…ç†æµ‹è¯•ç¯å¢ƒ ==="

# æ¸…ç†æ‰€æœ‰æµ‹è¯•ç”¨çš„ namespace
for ns in test-ns net-test ns1 ns2 ns3 port-test fw-test inspect-ns; do
    ip netns delete $ns 2>/dev/null && echo "åˆ é™¤ $ns" || true
done

# æ¸…ç†ç½‘æ¡¥
ip link delete br0 2>/dev/null && echo "åˆ é™¤ç½‘æ¡¥ br0" || true

# æ¸…ç† veth æ¥å£ï¼ˆé€šå¸¸ä¼šéš namespace è‡ªåŠ¨æ¸…ç†ï¼‰
for veth in veth-host veth-fw-host; do
    ip link delete $veth 2>/dev/null && echo "åˆ é™¤ $veth" || true
done

echo "æ¸…ç†å®Œæˆï¼"
```

## ğŸ’¡ å®ç”¨æŠ€å·§

### 1. å¿«é€Ÿåˆ›å»ºæµ‹è¯•ç¯å¢ƒ
```bash
# ä¸€é”®åˆ›å»ºå¸¦ç½‘ç»œçš„ namespace
create_ns_with_network() {
    local ns_name=$1
    local ip_addr=$2
    
    ip netns add $ns_name
    ip link add veth-$ns_name type veth peer name veth-$ns_name-peer
    ip link set veth-$ns_name-peer netns $ns_name
    ip netns exec $ns_name ip addr add $ip_addr dev veth-$ns_name-peer
    ip netns exec $ns_name ip link set veth-$ns_name-peer up
    ip netns exec $ns_name ip link set lo up
}

# ä½¿ç”¨ç¤ºä¾‹
create_ns_with_network test1 192.168.1.1/24
create_ns_with_network test2 192.168.1.2/24
```

### 2. ç›‘æ§ Network Namespace
```bash
# ç›‘æ§ç½‘ç»œæµé‡
ip netns exec your-namespace iftop -i interface

# ç›‘æ§è¿æ¥çŠ¶æ€
watch "ip netns exec your-namespace ss -tuln"

# ç›‘æ§è·¯ç”±å˜åŒ–
ip netns exec your-namespace ip monitor route
```

è¿™äº›æµ‹è¯•å‘½ä»¤å¯ä»¥å¸®åŠ©ä½ æ·±å…¥ç†è§£ Network Namespace çš„å·¥ä½œåŸç†ï¼Œå»ºè®®æŒ‰é¡ºåºæ‰§è¡Œå¹¶è§‚å¯Ÿæ¯ä¸ªæ­¥éª¤çš„è¾“å‡ºç»“æœï¼

